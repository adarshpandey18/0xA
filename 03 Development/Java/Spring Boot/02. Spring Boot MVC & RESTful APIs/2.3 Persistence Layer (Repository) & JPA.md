# Persistence Layer *(Repository)* & JPA

## JPA (Java Persistence API)
- Also knows as Jakarta Persistence API.
- JPA provider/specification can be Hibernate, OpenJPA etc. that helps in ORM (object relational mapping)
- In API JDBC we provide url db name password and SQL queries that should be executed.
- JPA helps us to perform CRUD operation
- (explain its meaning).
- Spring Data DPA  helps us to peform crud and other complex operations by default.
- we can also define our own methods.
![[jpa-diagram.png]]

### Example using H2 Database : 

Step 1 : Adding dependency 
spring-boot-starter-data-jpa
and 
h2 mvn reporsitory
 <!-- https://mvnrepository.com/artifact/com.h2database/h2 -->
<dependency>
    <groupId>com.h2database</groupId>
    <artifactId>h2</artifactId>
    <version>2.3.232</version>
    <scope>test</scope>
</dependency>


 Entity package
 @Entity - to convert java class to table inside the database
 @Table(name = "employees") - optional to set the table name other than class name
 - filed inside the class will be treated as column.
 @Id - marks the field as primary key.
	@GeneratedValue(strategry = GenerationType.IDENTITY) - used to auto increment value . has different strategy.
	@getter @setter - using lombook
	@AllArgsconstructor
	@noargsconstructor
	package com.tutorial.springmvc.springdata.entites;  
  
import jakarta.persistence.*;  
import lombok.AllArgsConstructor;  
import lombok.Getter;  
import lombok.NoArgsConstructor;  
import lombok.Setter;  
  
import java.time.LocalDate;  
  
@Entity  
@Getter  
@Setter  
@AllArgsConstructor  
@NoArgsConstructor  
@Table(name = "employee")  
public class EmployeeEntity {  
    @Id  
    @GeneratedValue(strategy = GenerationType.AUTO)  
    private Long id;  
    private String name;  
    private String email;  
    private Integer age;  
    private LocalDate dateOfJoining;  
    private Boolean isActive;  
}
package com.tutorial.springmvc.springdata.repositories;  
  
import com.tutorial.springmvc.springdata.entites.EmployeeEntity;  
import org.springframework.data.jpa.repository.JpaRepository;  
import org.springframework.stereotype.Repository;  
  
@Repository  
public interface EmployeeRepository  extends JpaRepository<EmployeeEntity, Long> {  
  
}package com.tutorial.springmvc.springdata.controller;  
  
import com.tutorial.springmvc.springdata.entites.EmployeeEntity;  
import com.tutorial.springmvc.springdata.repositories.EmployeeRepository;  
import org.springframework.web.bind.annotation.*;  
  
import java.util.List;  
  
@RestController  
@RequestMapping(path = "/employees")  
public class EmployeeController {  
  
    private final EmployeeRepository employeeRepository;  
  
    public EmployeeController(EmployeeRepository employeeRepository) {  
        this.employeeRepository = employeeRepository;  
    }  
  
    @GetMapping("/{employeeId}")  
    public EmployeeEntity findById(@PathVariable(value = "employeeId") Long id) {  
        return employeeRepository.findById(id).orElse(null);  
    }  
  
    @GetMapping  
    public List<EmployeeEntity> allEmployee() {  
        return employeeRepository.findAll();  
    }  
  
    @PostMapping  
    public EmployeeEntity saveEmployeeData(@RequestBody EmployeeEntity employeeEntity) {  
        return employeeRepository.save(employeeEntity);  
    }  
}


> ! here we are interacting directly with the repository layer instead of service layer for just testing but it is not the good practice to do so. 